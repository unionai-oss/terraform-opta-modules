{
  "resource": [
    {
      "aws_subnet": {
        "private_subnets": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_subnet.private_subnets",
            "Name": "opta-${var.layer_name}-private-${data.aws_availability_zones.current.zone_ids[count.index]}",
            "kubernetes.io/cluster/opta-${var.layer_name}": "shared",
            "type": "private",
            "terraform": "true",
            "kubernetes.io/role/internal-elb": "1"
          }
        }
      }
    },
    {
      "aws_route_table": {
        "private_route_tables": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}",
            "tf_address": "module.base.aws_route_table.private_route_tables",
            "Name": "opta-${var.layer_name}-private-${data.aws_availability_zones.current.zone_ids[count.index]}",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_route_table_association": {
        "private_associations": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_route_table_association.private_associations"
          }
        }
      }
    },
    {
      "aws_eip": {
        "nat_eips": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_eip.nat_eips",
            "Name": "opta-${var.layer_name}-nat-ip-${data.aws_availability_zones.current.zone_ids[count.index]}",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_nat_gateway": {
        "nat_gateways": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_nat_gateway.nat_gateways",
            "Name": "opta-${var.layer_name}-${data.aws_availability_zones.current.zone_ids[count.index]}",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_route": {
        "nat_routes": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_route.nat_routes"
          }
        }
      }
    },
    {
      "aws_ebs_default_kms_key": {
        "default": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_ebs_default_kms_key.default"
          }
        }
      }
    },
    {
      "aws_ebs_encryption_by_default": {
        "default": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_ebs_encryption_by_default.default"
          }
        }
      }
    },
    {
      "aws_kms_key": {
        "key": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_kms_key.key",
            "Name": "opta-${var.layer_name}",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_kms_alias": {
        "alias": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_kms_alias.alias"
          }
        }
      }
    },
    {
      "aws_docdb_subnet_group": {
        "main": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_docdb_subnet_group.main",
            "purpose": "docdb",
            "ignore-if-seemingly-out-of-place": "yup"
          }
        }
      }
    },
    {
      "aws_elasticache_subnet_group": {
        "main": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_elasticache_subnet_group.main"
          }
        }
      }
    },
    {
      "aws_db_subnet_group": {
        "main": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_db_subnet_group.main",
            "purpose": "postgres",
            "ignore-if-seemingly-out-of-place": "yup"
          }
        }
      }
    },
    {
      "aws_security_group": {
        "db": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_security_group.db"
          }
        }
      }
    },
    {
      "aws_security_group": {
        "elasticache": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_security_group.elasticache"
          }
        }
      }
    },
    {
      "aws_security_group": {
        "documentdb": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_security_group.documentdb"
          }
        }
      }
    },
    {
      "aws_subnet": {
        "public_subnets": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_subnet.public_subnets",
            "Name": "opta-${var.layer_name}-public-${data.aws_availability_zones.current.zone_ids[count.index]}",
            "kubernetes.io/cluster/opta-${var.layer_name}": "shared",
            "type": "public",
            "terraform": "true",
            "kubernetes.io/role/elb": "1"
          }
        }
      }
    },
    {
      "aws_route_table": {
        "public_route_table": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_route_table.public_route_table",
            "Name": "opta-${var.layer_name}-public",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_internet_gateway": {
        "igw": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_internet_gateway.igw",
            "Name": "opta-${var.layer_name}-internet-gateway",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_route": {
        "igw_routes": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_route.igw_routes"
          }
        }
      }
    },
    {
      "aws_route_table_association": {
        "public_association": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_route_table_association.public_association"
          }
        }
      }
    },
    {
      "random_id": {
        "bucket_suffix": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.random_id.bucket_suffix"
          }
        }
      }
    },
    {
      "aws_s3_bucket": {
        "log_bucket": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket.log_bucket"
          }
        }
      }
    },
    {
      "aws_s3_bucket_public_access_block": {
        "log_bucket": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket_public_access_block.log_bucket"
          }
        }
      }
    },
    {
      "aws_s3_bucket_acl": {
        "log_bucket": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket_acl.log_bucket"
          }
        }
      }
    },
    {
      "aws_s3_bucket_versioning": {
        "log_bucket": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket_versioning.log_bucket"
          }
        }
      }
    },
    {
      "aws_s3_bucket_server_side_encryption_configuration": {
        "log_bucket": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket_server_side_encryption_configuration.log_bucket"
          }
        }
      }
    },
    {
      "aws_s3_bucket_lifecycle_configuration": {
        "log_bucket": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket_lifecycle_configuration.log_bucket"
          }
        }
      }
    },
    {
      "aws_s3_bucket_policy": {
        "log_bucket_policy": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_s3_bucket_policy.log_bucket_policy"
          }
        }
      }
    },
    {
      "aws_vpc": {
        "vpc": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_vpc.vpc",
            "Name": "opta-${var.layer_name}",
            "terraform": "true"
          }
        }
      }
    },
    {
      "aws_default_security_group": {
        "default": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_default_security_group.default"
          }
        }
      }
    },
    {
      "aws_flow_log": {
        "vpc": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_flow_log.vpc"
          }
        }
      }
    },
    {
      "random_id": {
        "vpc_flow_log_suffix": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.random_id.vpc_flow_log_suffix"
          }
        }
      }
    },
    {
      "aws_cloudwatch_log_group": {
        "vpc_flow_log": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_cloudwatch_log_group.vpc_flow_log"
          }
        }
      }
    },
    {
      "aws_iam_role": {
        "vpc_flow_log": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_iam_role.vpc_flow_log"
          }
        }
      }
    },
    {
      "aws_iam_role_policy": {
        "vpc_flow_log": {
          "tags": {
            "opta": "true",
            "layer": "${var.env_name}" ,
            "tf_address": "module.base.aws_iam_role_policy.vpc_flow_log"
          }
        }
      }
    }
  ]
}
